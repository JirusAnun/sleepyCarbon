{"ast":null,"code":"var _jsxFileName = \"/Users/jirusanun/Downloads/sample-01/src/views/ExternalApi.js\",\n  _s = $RefreshSig$();\nimport React, { useState } from \"react\";\nimport { Button, Alert } from \"reactstrap\";\nimport Highlight from \"../components/Highlight\";\nimport { useAuth0, withAuthenticationRequired } from \"@auth0/auth0-react\";\nimport { getConfig } from \"../config\";\nimport Loading from \"../components/Loading\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ExternalApiComponent = () => {\n  _s();\n  const {\n    apiOrigin = \"http://localhost:3001\",\n    audience\n  } = getConfig();\n  const [state, setState] = useState({\n    showResult: false,\n    apiMessage: \"\",\n    error: null\n  });\n  const {\n    getAccessTokenSilently,\n    loginWithPopup,\n    getAccessTokenWithPopup\n  } = useAuth0();\n  const handleConsent = async () => {\n    try {\n      await getAccessTokenWithPopup();\n      setState({\n        ...state,\n        error: null\n      });\n    } catch (error) {\n      setState({\n        ...state,\n        error: error.error\n      });\n    }\n    await callApi();\n  };\n  const handleLoginAgain = async () => {\n    try {\n      await loginWithPopup();\n      setState({\n        ...state,\n        error: null\n      });\n    } catch (error) {\n      setState({\n        ...state,\n        error: error.error\n      });\n    }\n    await callApi();\n  };\n  const callApi = async () => {\n    try {\n      const token = await getAccessTokenSilently();\n      const response = await fetch(`${apiOrigin}/api/external`, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      const responseData = await response.json();\n      setState({\n        ...state,\n        showResult: true,\n        apiMessage: responseData\n      });\n    } catch (error) {\n      setState({\n        ...state,\n        error: error.error\n      });\n    }\n  };\n  const handle = (e, fn) => {\n    e.preventDefault();\n    fn();\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"text-center d-flex justify-content-center align-items-center h-100\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"Score: 100\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-5\",\n        children: [state.error === \"consent_required\" && /*#__PURE__*/_jsxDEV(Alert, {\n          color: \"warning\",\n          children: [\"You need to\", \" \", /*#__PURE__*/_jsxDEV(\"a\", {\n            href: \"#/\",\n            className: \"alert-link\",\n            onClick: e => handle(e, handleConsent),\n            children: \"consent to get access to users api\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 95,\n            columnNumber: 19\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 17\n        }, this), state.error === \"login_required\" && /*#__PURE__*/_jsxDEV(Alert, {\n          color: \"warning\",\n          children: [\"You need to\", \" \", /*#__PURE__*/_jsxDEV(\"a\", {\n            href: \"#/\",\n            className: \"alert-link\",\n            onClick: e => handle(e, handleLoginAgain),\n            children: \"log in again\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 108,\n            columnNumber: 19\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          color: \"primary\",\n          className: \"mt-5\",\n          onClick: callApi,\n          disabled: !audience,\n          children: \"Donate Carbon Credit\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"result-block-container\",\n        children: state.showResult && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"result-block\",\n          \"data-testid\": \"api-result\",\n          children: [/*#__PURE__*/_jsxDEV(\"h6\", {\n            className: \"muted\",\n            children: \"Result\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 131,\n            columnNumber: 19\n          }, this), /*#__PURE__*/_jsxDEV(Highlight, {\n            children: /*#__PURE__*/_jsxDEV(\"span\", {\n              children: JSON.stringify(state.apiMessage, null, 2)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 133,\n              columnNumber: 21\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 132,\n            columnNumber: 19\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 88,\n    columnNumber: 7\n  }, this);\n};\n_s(ExternalApiComponent, \"ed2YcTMvN8RLqSp2w/noWPz50zg=\", false, function () {\n  return [useAuth0];\n});\n_c = ExternalApiComponent;\nexport default _c2 = withAuthenticationRequired(ExternalApiComponent, {\n  onRedirecting: () => /*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 144,\n    columnNumber: 24\n  }, this)\n});\nvar _c, _c2;\n$RefreshReg$(_c, \"ExternalApiComponent\");\n$RefreshReg$(_c2, \"%default%\");","map":{"version":3,"names":["React","useState","Button","Alert","Highlight","useAuth0","withAuthenticationRequired","getConfig","Loading","jsxDEV","_jsxDEV","ExternalApiComponent","_s","apiOrigin","audience","state","setState","showResult","apiMessage","error","getAccessTokenSilently","loginWithPopup","getAccessTokenWithPopup","handleConsent","callApi","handleLoginAgain","token","response","fetch","headers","Authorization","responseData","json","handle","e","fn","preventDefault","className","children","fileName","_jsxFileName","lineNumber","columnNumber","color","href","onClick","disabled","JSON","stringify","_c","_c2","onRedirecting","$RefreshReg$"],"sources":["/Users/jirusanun/Downloads/sample-01/src/views/ExternalApi.js"],"sourcesContent":["import React, { useState } from \"react\";\nimport { Button, Alert } from \"reactstrap\";\nimport Highlight from \"../components/Highlight\";\nimport { useAuth0, withAuthenticationRequired } from \"@auth0/auth0-react\";\nimport { getConfig } from \"../config\";\nimport Loading from \"../components/Loading\";\n\nconst ExternalApiComponent = () => {\n  const { apiOrigin = \"http://localhost:3001\", audience } = getConfig();\n\n  const [state, setState] = useState({\n    showResult: false,\n    apiMessage: \"\",\n    error: null,\n  });\n\n  const {\n    getAccessTokenSilently,\n    loginWithPopup,\n    getAccessTokenWithPopup,\n  } = useAuth0();\n\n  const handleConsent = async () => {\n    try {\n      await getAccessTokenWithPopup();\n      setState({\n        ...state,\n        error: null,\n      });\n    } catch (error) {\n      setState({\n        ...state,\n        error: error.error,\n      });\n    }\n\n    await callApi();\n  };\n\n  const handleLoginAgain = async () => {\n    try {\n      await loginWithPopup();\n      setState({\n        ...state,\n        error: null,\n      });\n    } catch (error) {\n      setState({\n        ...state,\n        error: error.error,\n      });\n    }\n\n    await callApi();\n  };\n\n  const callApi = async () => {\n    try {\n      const token = await getAccessTokenSilently();\n\n      const response = await fetch(`${apiOrigin}/api/external`, {\n        headers: {\n          Authorization: `Bearer ${token}`,\n        },\n      });\n\n      const responseData = await response.json();\n\n      setState({\n        ...state,\n        showResult: true,\n        apiMessage: responseData,\n      });\n    } catch (error) {\n      setState({\n        ...state,\n        error: error.error,\n      });\n    }\n  };\n\n  const handle = (e, fn) => {\n    e.preventDefault();\n    fn();\n  };\n\n  return (\n      <div className=\"text-center d-flex justify-content-center align-items-center h-100\">\n        <div>\n          <h1>Score: 100</h1>\n          <div className=\"mb-5\">\n            {state.error === \"consent_required\" && (\n                <Alert color=\"warning\">\n                  You need to{\" \"}\n                  <a\n                      href=\"#/\"\n                      className=\"alert-link\"\n                      onClick={(e) => handle(e, handleConsent)}\n                  >\n                    consent to get access to users api\n                  </a>\n                </Alert>\n            )}\n\n            {state.error === \"login_required\" && (\n                <Alert color=\"warning\">\n                  You need to{\" \"}\n                  <a\n                      href=\"#/\"\n                      className=\"alert-link\"\n                      onClick={(e) => handle(e, handleLoginAgain)}\n                  >\n                    log in again\n                  </a>\n                </Alert>\n            )}\n\n            <Button\n                color=\"primary\"\n                className=\"mt-5\"\n                onClick={callApi}\n                disabled={!audience}\n            >\n              Donate Carbon Credit\n            </Button>\n          </div>\n\n          <div className=\"result-block-container\">\n            {state.showResult && (\n                <div className=\"result-block\" data-testid=\"api-result\">\n                  <h6 className=\"muted\">Result</h6>\n                  <Highlight>\n                    <span>{JSON.stringify(state.apiMessage, null, 2)}</span>\n                  </Highlight>\n                </div>\n            )}\n          </div>\n        </div>\n      </div>\n  );\n};\n\nexport default withAuthenticationRequired(ExternalApiComponent, {\n  onRedirecting: () => <Loading />,\n});\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,QAAQ,OAAO;AACvC,SAASC,MAAM,EAAEC,KAAK,QAAQ,YAAY;AAC1C,OAAOC,SAAS,MAAM,yBAAyB;AAC/C,SAASC,QAAQ,EAAEC,0BAA0B,QAAQ,oBAAoB;AACzE,SAASC,SAAS,QAAQ,WAAW;AACrC,OAAOC,OAAO,MAAM,uBAAuB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAE5C,MAAMC,oBAAoB,GAAGA,CAAA,KAAM;EAAAC,EAAA;EACjC,MAAM;IAAEC,SAAS,GAAG,uBAAuB;IAAEC;EAAS,CAAC,GAAGP,SAAS,CAAC,CAAC;EAErE,MAAM,CAACQ,KAAK,EAAEC,QAAQ,CAAC,GAAGf,QAAQ,CAAC;IACjCgB,UAAU,EAAE,KAAK;IACjBC,UAAU,EAAE,EAAE;IACdC,KAAK,EAAE;EACT,CAAC,CAAC;EAEF,MAAM;IACJC,sBAAsB;IACtBC,cAAc;IACdC;EACF,CAAC,GAAGjB,QAAQ,CAAC,CAAC;EAEd,MAAMkB,aAAa,GAAG,MAAAA,CAAA,KAAY;IAChC,IAAI;MACF,MAAMD,uBAAuB,CAAC,CAAC;MAC/BN,QAAQ,CAAC;QACP,GAAGD,KAAK;QACRI,KAAK,EAAE;MACT,CAAC,CAAC;IACJ,CAAC,CAAC,OAAOA,KAAK,EAAE;MACdH,QAAQ,CAAC;QACP,GAAGD,KAAK;QACRI,KAAK,EAAEA,KAAK,CAACA;MACf,CAAC,CAAC;IACJ;IAEA,MAAMK,OAAO,CAAC,CAAC;EACjB,CAAC;EAED,MAAMC,gBAAgB,GAAG,MAAAA,CAAA,KAAY;IACnC,IAAI;MACF,MAAMJ,cAAc,CAAC,CAAC;MACtBL,QAAQ,CAAC;QACP,GAAGD,KAAK;QACRI,KAAK,EAAE;MACT,CAAC,CAAC;IACJ,CAAC,CAAC,OAAOA,KAAK,EAAE;MACdH,QAAQ,CAAC;QACP,GAAGD,KAAK;QACRI,KAAK,EAAEA,KAAK,CAACA;MACf,CAAC,CAAC;IACJ;IAEA,MAAMK,OAAO,CAAC,CAAC;EACjB,CAAC;EAED,MAAMA,OAAO,GAAG,MAAAA,CAAA,KAAY;IAC1B,IAAI;MACF,MAAME,KAAK,GAAG,MAAMN,sBAAsB,CAAC,CAAC;MAE5C,MAAMO,QAAQ,GAAG,MAAMC,KAAK,CAAE,GAAEf,SAAU,eAAc,EAAE;QACxDgB,OAAO,EAAE;UACPC,aAAa,EAAG,UAASJ,KAAM;QACjC;MACF,CAAC,CAAC;MAEF,MAAMK,YAAY,GAAG,MAAMJ,QAAQ,CAACK,IAAI,CAAC,CAAC;MAE1ChB,QAAQ,CAAC;QACP,GAAGD,KAAK;QACRE,UAAU,EAAE,IAAI;QAChBC,UAAU,EAAEa;MACd,CAAC,CAAC;IACJ,CAAC,CAAC,OAAOZ,KAAK,EAAE;MACdH,QAAQ,CAAC;QACP,GAAGD,KAAK;QACRI,KAAK,EAAEA,KAAK,CAACA;MACf,CAAC,CAAC;IACJ;EACF,CAAC;EAED,MAAMc,MAAM,GAAGA,CAACC,CAAC,EAAEC,EAAE,KAAK;IACxBD,CAAC,CAACE,cAAc,CAAC,CAAC;IAClBD,EAAE,CAAC,CAAC;EACN,CAAC;EAED,oBACIzB,OAAA;IAAK2B,SAAS,EAAC,oEAAoE;IAAAC,QAAA,eACjF5B,OAAA;MAAA4B,QAAA,gBACE5B,OAAA;QAAA4B,QAAA,EAAI;MAAU;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eACnBhC,OAAA;QAAK2B,SAAS,EAAC,MAAM;QAAAC,QAAA,GAClBvB,KAAK,CAACI,KAAK,KAAK,kBAAkB,iBAC/BT,OAAA,CAACP,KAAK;UAACwC,KAAK,EAAC,SAAS;UAAAL,QAAA,GAAC,aACV,EAAC,GAAG,eACf5B,OAAA;YACIkC,IAAI,EAAC,IAAI;YACTP,SAAS,EAAC,YAAY;YACtBQ,OAAO,EAAGX,CAAC,IAAKD,MAAM,CAACC,CAAC,EAAEX,aAAa,CAAE;YAAAe,QAAA,EAC5C;UAED;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAG,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACC,CACV,EAEA3B,KAAK,CAACI,KAAK,KAAK,gBAAgB,iBAC7BT,OAAA,CAACP,KAAK;UAACwC,KAAK,EAAC,SAAS;UAAAL,QAAA,GAAC,aACV,EAAC,GAAG,eACf5B,OAAA;YACIkC,IAAI,EAAC,IAAI;YACTP,SAAS,EAAC,YAAY;YACtBQ,OAAO,EAAGX,CAAC,IAAKD,MAAM,CAACC,CAAC,EAAET,gBAAgB,CAAE;YAAAa,QAAA,EAC/C;UAED;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAG,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACC,CACV,eAEDhC,OAAA,CAACR,MAAM;UACHyC,KAAK,EAAC,SAAS;UACfN,SAAS,EAAC,MAAM;UAChBQ,OAAO,EAAErB,OAAQ;UACjBsB,QAAQ,EAAE,CAAChC,QAAS;UAAAwB,QAAA,EACvB;QAED;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACN,CAAC,eAENhC,OAAA;QAAK2B,SAAS,EAAC,wBAAwB;QAAAC,QAAA,EACpCvB,KAAK,CAACE,UAAU,iBACbP,OAAA;UAAK2B,SAAS,EAAC,cAAc;UAAC,eAAY,YAAY;UAAAC,QAAA,gBACpD5B,OAAA;YAAI2B,SAAS,EAAC,OAAO;YAAAC,QAAA,EAAC;UAAM;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,eACjChC,OAAA,CAACN,SAAS;YAAAkC,QAAA,eACR5B,OAAA;cAAA4B,QAAA,EAAOS,IAAI,CAACC,SAAS,CAACjC,KAAK,CAACG,UAAU,EAAE,IAAI,EAAE,CAAC;YAAC;cAAAqB,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAC/C,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACT;MACR;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACE,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH;EAAC;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACH,CAAC;AAEZ,CAAC;AAAC9B,EAAA,CArIID,oBAAoB;EAAA,QAapBN,QAAQ;AAAA;AAAA4C,EAAA,GAbRtC,oBAAoB;AAuI1B,eAAAuC,GAAA,GAAe5C,0BAA0B,CAACK,oBAAoB,EAAE;EAC9DwC,aAAa,EAAEA,CAAA,kBAAMzC,OAAA,CAACF,OAAO;IAAA+B,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAAE;AACjC,CAAC,CAAC;AAAC,IAAAO,EAAA,EAAAC,GAAA;AAAAE,YAAA,CAAAH,EAAA;AAAAG,YAAA,CAAAF,GAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}